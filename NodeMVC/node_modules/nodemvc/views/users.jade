extends layout
block content

	h2 Users

	if(users && users.length > 0)
		table.table.table-striped
			thead
				tr
					th User name
					th Email
					th Tasks assigned
					th Action
			tbody
				each user in users
					tr
						td 
							a(href=user.editLink) #{user.username}
						td
							a(href=user.editLink) #{user.email}
						td
							a(href=user.editLink) #{user.tasks.length}
						td
							button.btn.btn-danger(class="deleteButton", href=user.editLink, type="button", data-userid=user.id) Delete
							| 
							a.btn.btn-primary(href=user.editLink, role="button") Edit
	else
		p
			|No users found

	a.btn.btn-primary(href=addLink, role="button") Add user

	script.
		$('.deleteButton').click(function(){
			var userid = $(this).data('userid');

			// confirm dialog
			alertify.confirm("Are you sure you want to delete this user?", function (e) {
				if (e) {
					// user clicked "ok"
					$.postdatas({
						url: '/user/' + userid + '/delete',
						datas:[
							{ id: userid }
						]
					});
				} else {
					// user clicked "cancel"
				}
			});
		});