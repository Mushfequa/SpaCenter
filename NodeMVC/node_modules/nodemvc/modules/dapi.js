//	TESTING generic methods in sequelize
//	From: https://github.com/sequelize/sequelize-restful/blob/master/lib/router.js

var handleError = function(err,cb){
		console.log('Database error', err);
		cb(err);
	},
	handleSuccess = function(values,cb){
		console.log('Yay', values);
		cb(values);
	};

module.exports = {

	//	Pass in a model and an id and attributes, and hey presto.
	getById: function(modelName, id, include, success, error) {
		var daoFactory = db.sequelize.daoFactoryManager.getDAO(modelName);

		error = error || success;

		if (!!daoFactory) {
			daoFactory
				.find({
					where: { id: id },
					include: include || []
				})
				.success(function(entry) {
					handleSuccess(entry, success);
				}.bind(this))
				.error(function(err) {
					handleError(err, error)
				}.bind(this))
		} else {
			handleError("Unknown DAOFactory: " + modelName, error)
		}
	},

	//	Pass in a model and an id and attributes, and hey presto.
	updateById: function(modelName, id, attributes, success, error) {
		var daoFactory = db.sequelize.daoFactoryManager.getDAO(modelName);

		error = error || success;

		if (!!daoFactory) {
			daoFactory
				.find({ where: { id: id } })
				.success(function(entry) {
					entry.updateAttributes(attributes).complete(function(err, entry) {
						if (err) {
							handleError(err, error)
						} else {
							handleSuccess(entry.values, success)
						}
					}.bind(this))
				}.bind(this))
				.error(function(err) {
					handleError(err, error)
				}.bind(this))
		} else {
			handleError("Unknown DAOFactory: " + modelName, error)
		}
	}
};